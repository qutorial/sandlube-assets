!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(new class{constructor(){this.clientSecret=Sandlube.clientSecret,this.challengeToken=Sandlube.challengeToken,this.httpClient=Sandlube.httpClient()}inspectClient(){return{appVersion:navigator.appVersion,appName:navigator.appName,appCodeName:navigator.appCodeName}}run(){console.log("Running challenger code with client secret: "+this.clientSecret+" and challenge token "+this.challengeToken),this.httpClient.postResource("challenge-submission",this.inspectClient(),response=>{console.log("Challenge submission response: ",response)})}}).run(),__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__,exports,__webpack_require__(1)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(require,exports,tweetnacl_ts_1){Object.defineProperty(exports,"__esModule",{value:!0}),exports.checksum=void 0,exports.checksum=function(arr){return tweetnacl_ts_1.hash(arr).reduce((prev,curr,ind)=>prev^curr)}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,__webpack_exports__,__webpack_require__){"use strict";function ByteArray(n){return new Uint8Array(n)}function HalfArray(n){return new Uint16Array(n)}function WordArray(n){return new Uint32Array(n)}function IntArray(n){return new Int32Array(n)}function NumArray(n){return new Float64Array(n)}function validateBase64(s){if(!/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(s))throw new TypeError("invalid base64 string")}function validateHex(s){if(!/^(?:[A-Fa-f0-9]{2})+$/.test(s))throw new TypeError("invalid hex string")}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ByteArray",function(){return ByteArray}),__webpack_require__.d(__webpack_exports__,"HalfArray",function(){return HalfArray}),__webpack_require__.d(__webpack_exports__,"WordArray",function(){return WordArray}),__webpack_require__.d(__webpack_exports__,"IntArray",function(){return IntArray}),__webpack_require__.d(__webpack_exports__,"NumArray",function(){return NumArray}),__webpack_require__.d(__webpack_exports__,"validateBase64",function(){return validateBase64}),__webpack_require__.d(__webpack_exports__,"validateHex",function(){return validateHex}),__webpack_require__.d(__webpack_exports__,"encodeUTF8",function(){return encodeUTF8}),__webpack_require__.d(__webpack_exports__,"decodeUTF8",function(){return decodeUTF8}),__webpack_require__.d(__webpack_exports__,"encodeBase64",function(){return encodeBase64}),__webpack_require__.d(__webpack_exports__,"decodeBase64",function(){return decodeBase64}),__webpack_require__.d(__webpack_exports__,"encodeHex",function(){return encodeHex}),__webpack_require__.d(__webpack_exports__,"decodeHex",function(){return decodeHex}),__webpack_require__.d(__webpack_exports__,"_verify_16",function(){return _verify_16}),__webpack_require__.d(__webpack_exports__,"_verify_32",function(){return _verify_32}),__webpack_require__.d(__webpack_exports__,"verify",function(){return verify}),__webpack_require__.d(__webpack_exports__,"_randomBytes",function(){return _randomBytes}),__webpack_require__.d(__webpack_exports__,"randomBytes",function(){return randomBytes}),__webpack_require__.d(__webpack_exports__,"scalarMult",function(){return scalarMult}),__webpack_require__.d(__webpack_exports__,"scalarMult_base",function(){return scalarMult_base}),__webpack_require__.d(__webpack_exports__,"_scalarMult",function(){return _scalarMult}),__webpack_require__.d(__webpack_exports__,"_scalarMult_base",function(){return _scalarMult_base}),__webpack_require__.d(__webpack_exports__,"secretbox",function(){return secretbox}),__webpack_require__.d(__webpack_exports__,"secretbox_open",function(){return secretbox_open}),__webpack_require__.d(__webpack_exports__,"_onetimeauth",function(){return _onetimeauth}),__webpack_require__.d(__webpack_exports__,"box",function(){return box_box}),__webpack_require__.d(__webpack_exports__,"box_before",function(){return box_before}),__webpack_require__.d(__webpack_exports__,"box_after",function(){return box_after}),__webpack_require__.d(__webpack_exports__,"box_open",function(){return box_open}),__webpack_require__.d(__webpack_exports__,"box_open_after",function(){return box_open_after}),__webpack_require__.d(__webpack_exports__,"box_keyPair",function(){return box_keyPair}),__webpack_require__.d(__webpack_exports__,"box_keyPair_fromSecretKey",function(){return box_keyPair_fromSecretKey}),__webpack_require__.d(__webpack_exports__,"sign",function(){return sign}),__webpack_require__.d(__webpack_exports__,"sign_open",function(){return sign_open}),__webpack_require__.d(__webpack_exports__,"sign_detached",function(){return sign_detached}),__webpack_require__.d(__webpack_exports__,"sign_detached_verify",function(){return sign_detached_verify}),__webpack_require__.d(__webpack_exports__,"sign_keyPair",function(){return sign_keyPair}),__webpack_require__.d(__webpack_exports__,"sign_keyPair_fromSecretKey",function(){return sign_keyPair_fromSecretKey}),__webpack_require__.d(__webpack_exports__,"sign_keyPair_fromSeed",function(){return sign_keyPair_fromSeed}),__webpack_require__.d(__webpack_exports__,"scalarbase",function(){return scalarbase}),__webpack_require__.d(__webpack_exports__,"scalarmult",function(){return scalarmult}),__webpack_require__.d(__webpack_exports__,"hash",function(){return hash}),__webpack_require__.d(__webpack_exports__,"_hash",function(){return _hash}),__webpack_require__.d(__webpack_exports__,"auth",function(){return auth}),__webpack_require__.d(__webpack_exports__,"auth_full",function(){return auth_full}),__webpack_require__.d(__webpack_exports__,"blake2s",function(){return blake2s}),__webpack_require__.d(__webpack_exports__,"blake2s_init",function(){return blake2s_init}),__webpack_require__.d(__webpack_exports__,"blake2s_update",function(){return blake2s_update}),__webpack_require__.d(__webpack_exports__,"blake2s_final",function(){return blake2s_final}),__webpack_require__.d(__webpack_exports__,"blake2b",function(){return blake2b}),__webpack_require__.d(__webpack_exports__,"blake2b_init",function(){return blake2b_init}),__webpack_require__.d(__webpack_exports__,"blake2b_update",function(){return blake2b_update}),__webpack_require__.d(__webpack_exports__,"blake2b_final",function(){return blake2b_final}),__webpack_require__.d(__webpack_exports__,"sealedbox",function(){return sealedbox}),__webpack_require__.d(__webpack_exports__,"sealedbox_open",function(){return sealedbox_open});var fromCharCode=String.fromCharCode;function encodeUTF8(a){return decodeURIComponent(escape(fromCharCode.apply(void 0,a)))}function decodeUTF8(s){if("string"!=typeof s)throw new TypeError("expected string");for(var d=unescape(encodeURIComponent(s)),b=ByteArray(d.length),i=0;i<d.length;i++)b[i]=d.charCodeAt(i);return b}function encodeBase64(a){return btoa(fromCharCode.apply(void 0,a))}function decodeBase64(s){validateBase64(s);for(var d=atob(s),b=ByteArray(d.length),i=0;i<d.length;i++)b[i]=d.charCodeAt(i);return b}function put_hb(h){return h+(h<10?48:87)}function encodeHex(a){for(var b=ByteArray(a.length<<1),i=0,j=void 0;i<a.length;i++)b[j=i<<1]=put_hb(a[i]>>8),b[j+1]=put_hb(15&a[i]);return fromCharCode.apply(void 0,b)}function get_hb(s,i){var c=s.charCodeAt(i);return c-(c<58?48:c<71?55:87)}function decodeHex(s){validateHex(s);for(var a=ByteArray(s.length>>1),i=0;i<a.length;i+=2)a[i]=get_hb(s,i)<<8|get_hb(s,i+1);return a}function checkLengths(k,n){if(32!=k.length)throw new Error("bad key size");if(24!=n.length)throw new Error("bad nonce size")}function checkArrayTypes(){for(var arrays=[],_i=0;_i<arguments.length;_i++)arrays[_i]=arguments[_i];for(var _a=0,arrays_1=arrays;_a<arrays_1.length;_a++){if(!(arrays_1[_a]instanceof Uint8Array))throw new TypeError("unexpected type, use ByteArray")}}function vn(x,xi,y,yi,n){var i,d=0;for(i=0;i<n;i++)d|=x[xi+i]^y[yi+i];return(1&d-1>>>8)-1}function _verify_16(x,xi,y,yi){return vn(x,xi,y,yi,16)}function _verify_32(x,xi,y,yi){return vn(x,xi,y,yi,32)}function verify(x,y){return checkArrayTypes(x,y),x.length>0&&y.length>0&&x.length==y.length&&0==vn(x,0,y,0,x.length)}var QUOTE=65536;function _randomBytes(x,n){for(var i=0;i<n;i+=QUOTE)crypto.getRandomValues(x.subarray(i,i+Math.min(n-i,QUOTE)))}function randomBytes(n){var b=ByteArray(n);return _randomBytes(b,n),b}function gf(init){var r=NumArray(16);if(init)for(var i=0;i<init.length;i++)r[i]=init[i];return r}var _0=ByteArray(16),_9=ByteArray(32);_9[0]=9;var gf0=gf(),gf1=gf([1]),_121665=gf([56129,1]),D=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),D2=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),X=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Y=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),I=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function A(o,a,b){for(var i=0;i<16;i++)o[i]=a[i]+b[i]}function Z(o,a,b){for(var i=0;i<16;i++)o[i]=a[i]-b[i]}function M(o,a,b){var v,c,t0=0,t1=0,t2=0,t3=0,t4=0,t5=0,t6=0,t7=0,t8=0,t9=0,t10=0,t11=0,t12=0,t13=0,t14=0,t15=0,t16=0,t17=0,t18=0,t19=0,t20=0,t21=0,t22=0,t23=0,t24=0,t25=0,t26=0,t27=0,t28=0,t29=0,t30=0,b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5],b6=b[6],b7=b[7],b8=b[8],b9=b[9],b10=b[10],b11=b[11],b12=b[12],b13=b[13],b14=b[14],b15=b[15];t0+=(v=a[0])*b0,t1+=v*b1,t2+=v*b2,t3+=v*b3,t4+=v*b4,t5+=v*b5,t6+=v*b6,t7+=v*b7,t8+=v*b8,t9+=v*b9,t10+=v*b10,t11+=v*b11,t12+=v*b12,t13+=v*b13,t14+=v*b14,t15+=v*b15,t1+=(v=a[1])*b0,t2+=v*b1,t3+=v*b2,t4+=v*b3,t5+=v*b4,t6+=v*b5,t7+=v*b6,t8+=v*b7,t9+=v*b8,t10+=v*b9,t11+=v*b10,t12+=v*b11,t13+=v*b12,t14+=v*b13,t15+=v*b14,t16+=v*b15,t2+=(v=a[2])*b0,t3+=v*b1,t4+=v*b2,t5+=v*b3,t6+=v*b4,t7+=v*b5,t8+=v*b6,t9+=v*b7,t10+=v*b8,t11+=v*b9,t12+=v*b10,t13+=v*b11,t14+=v*b12,t15+=v*b13,t16+=v*b14,t17+=v*b15,t3+=(v=a[3])*b0,t4+=v*b1,t5+=v*b2,t6+=v*b3,t7+=v*b4,t8+=v*b5,t9+=v*b6,t10+=v*b7,t11+=v*b8,t12+=v*b9,t13+=v*b10,t14+=v*b11,t15+=v*b12,t16+=v*b13,t17+=v*b14,t18+=v*b15,t4+=(v=a[4])*b0,t5+=v*b1,t6+=v*b2,t7+=v*b3,t8+=v*b4,t9+=v*b5,t10+=v*b6,t11+=v*b7,t12+=v*b8,t13+=v*b9,t14+=v*b10,t15+=v*b11,t16+=v*b12,t17+=v*b13,t18+=v*b14,t19+=v*b15,t5+=(v=a[5])*b0,t6+=v*b1,t7+=v*b2,t8+=v*b3,t9+=v*b4,t10+=v*b5,t11+=v*b6,t12+=v*b7,t13+=v*b8,t14+=v*b9,t15+=v*b10,t16+=v*b11,t17+=v*b12,t18+=v*b13,t19+=v*b14,t20+=v*b15,t6+=(v=a[6])*b0,t7+=v*b1,t8+=v*b2,t9+=v*b3,t10+=v*b4,t11+=v*b5,t12+=v*b6,t13+=v*b7,t14+=v*b8,t15+=v*b9,t16+=v*b10,t17+=v*b11,t18+=v*b12,t19+=v*b13,t20+=v*b14,t21+=v*b15,t7+=(v=a[7])*b0,t8+=v*b1,t9+=v*b2,t10+=v*b3,t11+=v*b4,t12+=v*b5,t13+=v*b6,t14+=v*b7,t15+=v*b8,t16+=v*b9,t17+=v*b10,t18+=v*b11,t19+=v*b12,t20+=v*b13,t21+=v*b14,t22+=v*b15,t8+=(v=a[8])*b0,t9+=v*b1,t10+=v*b2,t11+=v*b3,t12+=v*b4,t13+=v*b5,t14+=v*b6,t15+=v*b7,t16+=v*b8,t17+=v*b9,t18+=v*b10,t19+=v*b11,t20+=v*b12,t21+=v*b13,t22+=v*b14,t23+=v*b15,t9+=(v=a[9])*b0,t10+=v*b1,t11+=v*b2,t12+=v*b3,t13+=v*b4,t14+=v*b5,t15+=v*b6,t16+=v*b7,t17+=v*b8,t18+=v*b9,t19+=v*b10,t20+=v*b11,t21+=v*b12,t22+=v*b13,t23+=v*b14,t24+=v*b15,t10+=(v=a[10])*b0,t11+=v*b1,t12+=v*b2,t13+=v*b3,t14+=v*b4,t15+=v*b5,t16+=v*b6,t17+=v*b7,t18+=v*b8,t19+=v*b9,t20+=v*b10,t21+=v*b11,t22+=v*b12,t23+=v*b13,t24+=v*b14,t25+=v*b15,t11+=(v=a[11])*b0,t12+=v*b1,t13+=v*b2,t14+=v*b3,t15+=v*b4,t16+=v*b5,t17+=v*b6,t18+=v*b7,t19+=v*b8,t20+=v*b9,t21+=v*b10,t22+=v*b11,t23+=v*b12,t24+=v*b13,t25+=v*b14,t26+=v*b15,t12+=(v=a[12])*b0,t13+=v*b1,t14+=v*b2,t15+=v*b3,t16+=v*b4,t17+=v*b5,t18+=v*b6,t19+=v*b7,t20+=v*b8,t21+=v*b9,t22+=v*b10,t23+=v*b11,t24+=v*b12,t25+=v*b13,t26+=v*b14,t27+=v*b15,t13+=(v=a[13])*b0,t14+=v*b1,t15+=v*b2,t16+=v*b3,t17+=v*b4,t18+=v*b5,t19+=v*b6,t20+=v*b7,t21+=v*b8,t22+=v*b9,t23+=v*b10,t24+=v*b11,t25+=v*b12,t26+=v*b13,t27+=v*b14,t28+=v*b15,t14+=(v=a[14])*b0,t15+=v*b1,t16+=v*b2,t17+=v*b3,t18+=v*b4,t19+=v*b5,t20+=v*b6,t21+=v*b7,t22+=v*b8,t23+=v*b9,t24+=v*b10,t25+=v*b11,t26+=v*b12,t27+=v*b13,t28+=v*b14,t29+=v*b15,t15+=(v=a[15])*b0,t1+=38*(t17+=v*b2),t2+=38*(t18+=v*b3),t3+=38*(t19+=v*b4),t4+=38*(t20+=v*b5),t5+=38*(t21+=v*b6),t6+=38*(t22+=v*b7),t7+=38*(t23+=v*b8),t8+=38*(t24+=v*b9),t9+=38*(t25+=v*b10),t10+=38*(t26+=v*b11),t11+=38*(t27+=v*b12),t12+=38*(t28+=v*b13),t13+=38*(t29+=v*b14),t14+=38*(t30+=v*b15),t0=(v=(t0+=38*(t16+=v*b1))+(c=1)+65535)-65536*(c=Math.floor(v/65536)),t1=(v=t1+c+65535)-65536*(c=Math.floor(v/65536)),t2=(v=t2+c+65535)-65536*(c=Math.floor(v/65536)),t3=(v=t3+c+65535)-65536*(c=Math.floor(v/65536)),t4=(v=t4+c+65535)-65536*(c=Math.floor(v/65536)),t5=(v=t5+c+65535)-65536*(c=Math.floor(v/65536)),t6=(v=t6+c+65535)-65536*(c=Math.floor(v/65536)),t7=(v=t7+c+65535)-65536*(c=Math.floor(v/65536)),t8=(v=t8+c+65535)-65536*(c=Math.floor(v/65536)),t9=(v=t9+c+65535)-65536*(c=Math.floor(v/65536)),t10=(v=t10+c+65535)-65536*(c=Math.floor(v/65536)),t11=(v=t11+c+65535)-65536*(c=Math.floor(v/65536)),t12=(v=t12+c+65535)-65536*(c=Math.floor(v/65536)),t13=(v=t13+c+65535)-65536*(c=Math.floor(v/65536)),t14=(v=t14+c+65535)-65536*(c=Math.floor(v/65536)),t15=(v=t15+c+65535)-65536*(c=Math.floor(v/65536)),t0=(v=(t0+=c-1+37*(c-1))+(c=1)+65535)-65536*(c=Math.floor(v/65536)),t1=(v=t1+c+65535)-65536*(c=Math.floor(v/65536)),t2=(v=t2+c+65535)-65536*(c=Math.floor(v/65536)),t3=(v=t3+c+65535)-65536*(c=Math.floor(v/65536)),t4=(v=t4+c+65535)-65536*(c=Math.floor(v/65536)),t5=(v=t5+c+65535)-65536*(c=Math.floor(v/65536)),t6=(v=t6+c+65535)-65536*(c=Math.floor(v/65536)),t7=(v=t7+c+65535)-65536*(c=Math.floor(v/65536)),t8=(v=t8+c+65535)-65536*(c=Math.floor(v/65536)),t9=(v=t9+c+65535)-65536*(c=Math.floor(v/65536)),t10=(v=t10+c+65535)-65536*(c=Math.floor(v/65536)),t11=(v=t11+c+65535)-65536*(c=Math.floor(v/65536)),t12=(v=t12+c+65535)-65536*(c=Math.floor(v/65536)),t13=(v=t13+c+65535)-65536*(c=Math.floor(v/65536)),t14=(v=t14+c+65535)-65536*(c=Math.floor(v/65536)),t15=(v=t15+c+65535)-65536*(c=Math.floor(v/65536)),t0+=c-1+37*(c-1),o[0]=t0,o[1]=t1,o[2]=t2,o[3]=t3,o[4]=t4,o[5]=t5,o[6]=t6,o[7]=t7,o[8]=t8,o[9]=t9,o[10]=t10,o[11]=t11,o[12]=t12,o[13]=t13,o[14]=t14,o[15]=t15}function S(o,a){M(o,a,a)}function set25519(r,a){for(var i=0;i<16;i++)r[i]=0|a[i]}function car25519(o){var i,v,c=1;for(i=0;i<16;i++)v=o[i]+c+65535,c=Math.floor(v/65536),o[i]=v-65536*c;o[0]+=c-1+37*(c-1)}function sel25519(p,q,b){for(var t,c=~(b-1),i=0;i<16;i++)t=c&(p[i]^q[i]),p[i]^=t,q[i]^=t}function pack25519(o,n){var i,j,b,m=gf(),t=gf();for(i=0;i<16;i++)t[i]=n[i];for(car25519(t),car25519(t),car25519(t),j=0;j<2;j++){for(m[0]=t[0]-65517,i=1;i<15;i++)m[i]=t[i]-65535-(m[i-1]>>16&1),m[i-1]&=65535;m[15]=t[15]-32767-(m[14]>>16&1),b=m[15]>>16&1,m[14]&=65535,sel25519(t,m,1-b)}for(i=0;i<16;i++)o[2*i]=255&t[i],o[2*i+1]=t[i]>>8}function neq25519(a,b){var c=ByteArray(32),d=ByteArray(32);return pack25519(c,a),pack25519(d,b),_verify_32(c,0,d,0)}function par25519(a){var d=ByteArray(32);return pack25519(d,a),1&d[0]}function unpack25519(o,n){for(var i=0;i<16;i++)o[i]=n[2*i]+(n[2*i+1]<<8);o[15]&=32767}function inv25519(o,i){var a,c=gf();for(a=0;a<16;a++)c[a]=i[a];for(a=253;a>=0;a--)S(c,c),2!==a&&4!==a&&M(c,c,i);for(a=0;a<16;a++)o[a]=c[a]}function scalarMult(n,p){if(checkArrayTypes(n,p),32!==n.length)throw new Error("bad n size");if(32!==p.length)throw new Error("bad p size");var q=ByteArray(32);return _scalarMult(q,n,p),q}function scalarMult_base(n){if(checkArrayTypes(n),32!==n.length)throw new Error("bad n size");var q=ByteArray(32);return _scalarMult_base(q,n),q}function _scalarMult(q,n,p){var r,i,z=ByteArray(32),x=NumArray(80),a=gf(),b=gf(),c=gf(),d=gf(),e=gf(),f=gf();for(i=0;i<31;i++)z[i]=n[i];for(z[31]=127&n[31]|64,z[0]&=248,unpack25519(x,p),i=0;i<16;i++)b[i]=x[i],d[i]=a[i]=c[i]=0;for(a[0]=d[0]=1,i=254;i>=0;--i)sel25519(a,b,r=z[i>>>3]>>>(7&i)&1),sel25519(c,d,r),A(e,a,c),Z(a,a,c),A(c,b,d),Z(b,b,d),S(d,e),S(f,a),M(a,c,a),M(c,b,e),A(e,a,c),Z(a,a,c),S(b,a),Z(c,d,f),M(a,c,_121665),A(a,a,d),M(c,c,a),M(a,d,f),M(d,b,x),S(b,e),sel25519(a,b,r),sel25519(c,d,r);for(i=0;i<16;i++)x[i+16]=a[i],x[i+32]=c[i],x[i+48]=b[i],x[i+64]=d[i];var x32=x.subarray(32),x16=x.subarray(16);return inv25519(x32,x32),M(x16,x16,x32),pack25519(q,x16),0}function _scalarMult_base(q,n){return _scalarMult(q,n,_9)}function _salsa20(o,p,k,c){for(var u,j0=255&c[0]|(255&c[1])<<8|(255&c[2])<<16|(255&c[3])<<24,j1=255&k[0]|(255&k[1])<<8|(255&k[2])<<16|(255&k[3])<<24,j2=255&k[4]|(255&k[5])<<8|(255&k[6])<<16|(255&k[7])<<24,j3=255&k[8]|(255&k[9])<<8|(255&k[10])<<16|(255&k[11])<<24,j4=255&k[12]|(255&k[13])<<8|(255&k[14])<<16|(255&k[15])<<24,j5=255&c[4]|(255&c[5])<<8|(255&c[6])<<16|(255&c[7])<<24,j6=255&p[0]|(255&p[1])<<8|(255&p[2])<<16|(255&p[3])<<24,j7=255&p[4]|(255&p[5])<<8|(255&p[6])<<16|(255&p[7])<<24,j8=255&p[8]|(255&p[9])<<8|(255&p[10])<<16|(255&p[11])<<24,j9=255&p[12]|(255&p[13])<<8|(255&p[14])<<16|(255&p[15])<<24,j10=255&c[8]|(255&c[9])<<8|(255&c[10])<<16|(255&c[11])<<24,j11=255&k[16]|(255&k[17])<<8|(255&k[18])<<16|(255&k[19])<<24,j12=255&k[20]|(255&k[21])<<8|(255&k[22])<<16|(255&k[23])<<24,j13=255&k[24]|(255&k[25])<<8|(255&k[26])<<16|(255&k[27])<<24,j14=255&k[28]|(255&k[29])<<8|(255&k[30])<<16|(255&k[31])<<24,j15=255&c[12]|(255&c[13])<<8|(255&c[14])<<16|(255&c[15])<<24,x0=j0,x1=j1,x2=j2,x3=j3,x4=j4,x5=j5,x6=j6,x7=j7,x8=j8,x9=j9,x10=j10,x11=j11,x12=j12,x13=j13,x14=j14,x15=j15,i=0;i<20;i+=2)x0^=(u=(x12^=(u=(x8^=(u=(x4^=(u=x0+x12|0)<<7|u>>>25)+x0|0)<<9|u>>>23)+x4|0)<<13|u>>>19)+x8|0)<<18|u>>>14,x5^=(u=(x1^=(u=(x13^=(u=(x9^=(u=x5+x1|0)<<7|u>>>25)+x5|0)<<9|u>>>23)+x9|0)<<13|u>>>19)+x13|0)<<18|u>>>14,x10^=(u=(x6^=(u=(x2^=(u=(x14^=(u=x10+x6|0)<<7|u>>>25)+x10|0)<<9|u>>>23)+x14|0)<<13|u>>>19)+x2|0)<<18|u>>>14,x15^=(u=(x11^=(u=(x7^=(u=(x3^=(u=x15+x11|0)<<7|u>>>25)+x15|0)<<9|u>>>23)+x3|0)<<13|u>>>19)+x7|0)<<18|u>>>14,x0^=(u=(x3^=(u=(x2^=(u=(x1^=(u=x0+x3|0)<<7|u>>>25)+x0|0)<<9|u>>>23)+x1|0)<<13|u>>>19)+x2|0)<<18|u>>>14,x5^=(u=(x4^=(u=(x7^=(u=(x6^=(u=x5+x4|0)<<7|u>>>25)+x5|0)<<9|u>>>23)+x6|0)<<13|u>>>19)+x7|0)<<18|u>>>14,x10^=(u=(x9^=(u=(x8^=(u=(x11^=(u=x10+x9|0)<<7|u>>>25)+x10|0)<<9|u>>>23)+x11|0)<<13|u>>>19)+x8|0)<<18|u>>>14,x15^=(u=(x14^=(u=(x13^=(u=(x12^=(u=x15+x14|0)<<7|u>>>25)+x15|0)<<9|u>>>23)+x12|0)<<13|u>>>19)+x13|0)<<18|u>>>14;x0=x0+j0|0,x1=x1+j1|0,x2=x2+j2|0,x3=x3+j3|0,x4=x4+j4|0,x5=x5+j5|0,x6=x6+j6|0,x7=x7+j7|0,x8=x8+j8|0,x9=x9+j9|0,x10=x10+j10|0,x11=x11+j11|0,x12=x12+j12|0,x13=x13+j13|0,x14=x14+j14|0,x15=x15+j15|0,o[0]=x0>>>0&255,o[1]=x0>>>8&255,o[2]=x0>>>16&255,o[3]=x0>>>24&255,o[4]=x1>>>0&255,o[5]=x1>>>8&255,o[6]=x1>>>16&255,o[7]=x1>>>24&255,o[8]=x2>>>0&255,o[9]=x2>>>8&255,o[10]=x2>>>16&255,o[11]=x2>>>24&255,o[12]=x3>>>0&255,o[13]=x3>>>8&255,o[14]=x3>>>16&255,o[15]=x3>>>24&255,o[16]=x4>>>0&255,o[17]=x4>>>8&255,o[18]=x4>>>16&255,o[19]=x4>>>24&255,o[20]=x5>>>0&255,o[21]=x5>>>8&255,o[22]=x5>>>16&255,o[23]=x5>>>24&255,o[24]=x6>>>0&255,o[25]=x6>>>8&255,o[26]=x6>>>16&255,o[27]=x6>>>24&255,o[28]=x7>>>0&255,o[29]=x7>>>8&255,o[30]=x7>>>16&255,o[31]=x7>>>24&255,o[32]=x8>>>0&255,o[33]=x8>>>8&255,o[34]=x8>>>16&255,o[35]=x8>>>24&255,o[36]=x9>>>0&255,o[37]=x9>>>8&255,o[38]=x9>>>16&255,o[39]=x9>>>24&255,o[40]=x10>>>0&255,o[41]=x10>>>8&255,o[42]=x10>>>16&255,o[43]=x10>>>24&255,o[44]=x11>>>0&255,o[45]=x11>>>8&255,o[46]=x11>>>16&255,o[47]=x11>>>24&255,o[48]=x12>>>0&255,o[49]=x12>>>8&255,o[50]=x12>>>16&255,o[51]=x12>>>24&255,o[52]=x13>>>0&255,o[53]=x13>>>8&255,o[54]=x13>>>16&255,o[55]=x13>>>24&255,o[56]=x14>>>0&255,o[57]=x14>>>8&255,o[58]=x14>>>16&255,o[59]=x14>>>24&255,o[60]=x15>>>0&255,o[61]=x15>>>8&255,o[62]=x15>>>16&255,o[63]=x15>>>24&255}function _hsalsa20(o,p,k,c){for(var u,x0=255&c[0]|(255&c[1])<<8|(255&c[2])<<16|(255&c[3])<<24,x1=255&k[0]|(255&k[1])<<8|(255&k[2])<<16|(255&k[3])<<24,x2=255&k[4]|(255&k[5])<<8|(255&k[6])<<16|(255&k[7])<<24,x3=255&k[8]|(255&k[9])<<8|(255&k[10])<<16|(255&k[11])<<24,x4=255&k[12]|(255&k[13])<<8|(255&k[14])<<16|(255&k[15])<<24,x5=255&c[4]|(255&c[5])<<8|(255&c[6])<<16|(255&c[7])<<24,x6=255&p[0]|(255&p[1])<<8|(255&p[2])<<16|(255&p[3])<<24,x7=255&p[4]|(255&p[5])<<8|(255&p[6])<<16|(255&p[7])<<24,x8=255&p[8]|(255&p[9])<<8|(255&p[10])<<16|(255&p[11])<<24,x9=255&p[12]|(255&p[13])<<8|(255&p[14])<<16|(255&p[15])<<24,x10=255&c[8]|(255&c[9])<<8|(255&c[10])<<16|(255&c[11])<<24,x11=255&k[16]|(255&k[17])<<8|(255&k[18])<<16|(255&k[19])<<24,x12=255&k[20]|(255&k[21])<<8|(255&k[22])<<16|(255&k[23])<<24,x13=255&k[24]|(255&k[25])<<8|(255&k[26])<<16|(255&k[27])<<24,x14=255&k[28]|(255&k[29])<<8|(255&k[30])<<16|(255&k[31])<<24,x15=255&c[12]|(255&c[13])<<8|(255&c[14])<<16|(255&c[15])<<24,i=0;i<20;i+=2)x0^=(u=(x12^=(u=(x8^=(u=(x4^=(u=x0+x12|0)<<7|u>>>25)+x0|0)<<9|u>>>23)+x4|0)<<13|u>>>19)+x8|0)<<18|u>>>14,x5^=(u=(x1^=(u=(x13^=(u=(x9^=(u=x5+x1|0)<<7|u>>>25)+x5|0)<<9|u>>>23)+x9|0)<<13|u>>>19)+x13|0)<<18|u>>>14,x10^=(u=(x6^=(u=(x2^=(u=(x14^=(u=x10+x6|0)<<7|u>>>25)+x10|0)<<9|u>>>23)+x14|0)<<13|u>>>19)+x2|0)<<18|u>>>14,x15^=(u=(x11^=(u=(x7^=(u=(x3^=(u=x15+x11|0)<<7|u>>>25)+x15|0)<<9|u>>>23)+x3|0)<<13|u>>>19)+x7|0)<<18|u>>>14,x0^=(u=(x3^=(u=(x2^=(u=(x1^=(u=x0+x3|0)<<7|u>>>25)+x0|0)<<9|u>>>23)+x1|0)<<13|u>>>19)+x2|0)<<18|u>>>14,x5^=(u=(x4^=(u=(x7^=(u=(x6^=(u=x5+x4|0)<<7|u>>>25)+x5|0)<<9|u>>>23)+x6|0)<<13|u>>>19)+x7|0)<<18|u>>>14,x10^=(u=(x9^=(u=(x8^=(u=(x11^=(u=x10+x9|0)<<7|u>>>25)+x10|0)<<9|u>>>23)+x11|0)<<13|u>>>19)+x8|0)<<18|u>>>14,x15^=(u=(x14^=(u=(x13^=(u=(x12^=(u=x15+x14|0)<<7|u>>>25)+x15|0)<<9|u>>>23)+x12|0)<<13|u>>>19)+x13|0)<<18|u>>>14;o[0]=x0>>>0&255,o[1]=x0>>>8&255,o[2]=x0>>>16&255,o[3]=x0>>>24&255,o[4]=x5>>>0&255,o[5]=x5>>>8&255,o[6]=x5>>>16&255,o[7]=x5>>>24&255,o[8]=x10>>>0&255,o[9]=x10>>>8&255,o[10]=x10>>>16&255,o[11]=x10>>>24&255,o[12]=x15>>>0&255,o[13]=x15>>>8&255,o[14]=x15>>>16&255,o[15]=x15>>>24&255,o[16]=x6>>>0&255,o[17]=x6>>>8&255,o[18]=x6>>>16&255,o[19]=x6>>>24&255,o[20]=x7>>>0&255,o[21]=x7>>>8&255,o[22]=x7>>>16&255,o[23]=x7>>>24&255,o[24]=x8>>>0&255,o[25]=x8>>>8&255,o[26]=x8>>>16&255,o[27]=x8>>>24&255,o[28]=x9>>>0&255,o[29]=x9>>>8&255,o[30]=x9>>>16&255,o[31]=x9>>>24&255}var _sigma=ByteArray([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function _stream(c,cpos,d,n,k){var s=ByteArray(32),sn=ByteArray(8);_hsalsa20(s,n,k,_sigma);for(var i=0;i<8;i++)sn[i]=n[i+16];return function(c,cpos,b,n,k){var u,i,z=ByteArray(16),x=ByteArray(64);for(i=0;i<16;i++)z[i]=0;for(i=0;i<8;i++)z[i]=n[i];for(;b>=64;){for(_salsa20(x,z,k,_sigma),i=0;i<64;i++)c[cpos+i]=x[i];for(u=1,i=8;i<16;i++)u=u+(255&z[i])|0,z[i]=255&u,u>>>=8;b-=64,cpos+=64}if(b>0)for(_salsa20(x,z,k,_sigma),i=0;i<b;i++)c[cpos+i]=x[i];return 0}(c,cpos,d,sn,s)}function _stream_xor(c,cpos,m,mpos,d,n,k){var s=ByteArray(32),sn=ByteArray(8);_hsalsa20(s,n,k,_sigma);for(var i=0;i<8;i++)sn[i]=n[i+16];return function(c,cpos,m,mpos,b,n,k){var u,i,z=ByteArray(16),x=ByteArray(64);for(i=0;i<16;i++)z[i]=0;for(i=0;i<8;i++)z[i]=n[i];for(;b>=64;){for(_salsa20(x,z,k,_sigma),i=0;i<64;i++)c[cpos+i]=m[mpos+i]^x[i];for(u=1,i=8;i<16;i++)u=u+(255&z[i])|0,z[i]=255&u,u>>>=8;b-=64,cpos+=64,mpos+=64}if(b>0)for(_salsa20(x,z,k,_sigma),i=0;i<b;i++)c[cpos+i]=m[mpos+i]^x[i];return 0}(c,cpos,m,mpos,d,sn,s)}function poly1305_blocks(self,m,mpos,bytes){for(var t0,t1,t2,t3,t4,t5,t6,t7,c,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,hibit=self.fin?0:2048,h=self.h,r=self.r,h0=h[0],h1=h[1],h2=h[2],h3=h[3],h4=h[4],h5=h[5],h6=h[6],h7=h[7],h8=h[8],h9=h[9],r0=r[0],r1=r[1],r2=r[2],r3=r[3],r4=r[4],r5=r[5],r6=r[6],r7=r[7],r8=r[8],r9=r[9];bytes>=16;)h0+=8191&(t0=255&m[mpos+0]|(255&m[mpos+1])<<8),h1+=8191&(t0>>>13|(t1=255&m[mpos+2]|(255&m[mpos+3])<<8)<<3),h2+=8191&(t1>>>10|(t2=255&m[mpos+4]|(255&m[mpos+5])<<8)<<6),h3+=8191&(t2>>>7|(t3=255&m[mpos+6]|(255&m[mpos+7])<<8)<<9),h4+=8191&(t3>>>4|(t4=255&m[mpos+8]|(255&m[mpos+9])<<8)<<12),h5+=t4>>>1&8191,h6+=8191&(t4>>>14|(t5=255&m[mpos+10]|(255&m[mpos+11])<<8)<<2),h7+=8191&(t5>>>11|(t6=255&m[mpos+12]|(255&m[mpos+13])<<8)<<5),t7=255&m[mpos+14]|(255&m[mpos+15])<<8,d0=c=0,d0+=h0*r0,d0+=h1*(5*r9),d0+=h2*(5*r8),d0+=h3*(5*r7),c=(d0+=h4*(5*r6))>>>13,d0&=8191,d0+=h5*(5*r5),d0+=h6*(5*r4),d0+=h7*(5*r3),d0+=(h8+=8191&(t6>>>8|t7<<8))*(5*r2),d1=c+=(d0+=(h9+=t7>>>5|hibit)*(5*r1))>>>13,d1+=h0*r1,d1+=h1*r0,d1+=h2*(5*r9),d1+=h3*(5*r8),c=(d1+=h4*(5*r7))>>>13,d1&=8191,d1+=h5*(5*r6),d1+=h6*(5*r5),d1+=h7*(5*r4),d1+=h8*(5*r3),c+=(d1+=h9*(5*r2))>>>13,d1&=8191,d2=c,d2+=h0*r2,d2+=h1*r1,d2+=h2*r0,d2+=h3*(5*r9),c=(d2+=h4*(5*r8))>>>13,d2&=8191,d2+=h5*(5*r7),d2+=h6*(5*r6),d2+=h7*(5*r5),d2+=h8*(5*r4),d3=c+=(d2+=h9*(5*r3))>>>13,d3+=h0*r3,d3+=h1*r2,d3+=h2*r1,d3+=h3*r0,c=(d3+=h4*(5*r9))>>>13,d3&=8191,d3+=h5*(5*r8),d3+=h6*(5*r7),d3+=h7*(5*r6),d3+=h8*(5*r5),d4=c+=(d3+=h9*(5*r4))>>>13,d4+=h0*r4,d4+=h1*r3,d4+=h2*r2,d4+=h3*r1,c=(d4+=h4*r0)>>>13,d4&=8191,d4+=h5*(5*r9),d4+=h6*(5*r8),d4+=h7*(5*r7),d4+=h8*(5*r6),d5=c+=(d4+=h9*(5*r5))>>>13,d5+=h0*r5,d5+=h1*r4,d5+=h2*r3,d5+=h3*r2,c=(d5+=h4*r1)>>>13,d5&=8191,d5+=h5*r0,d5+=h6*(5*r9),d5+=h7*(5*r8),d5+=h8*(5*r7),d6=c+=(d5+=h9*(5*r6))>>>13,d6+=h0*r6,d6+=h1*r5,d6+=h2*r4,d6+=h3*r3,c=(d6+=h4*r2)>>>13,d6&=8191,d6+=h5*r1,d6+=h6*r0,d6+=h7*(5*r9),d6+=h8*(5*r8),d7=c+=(d6+=h9*(5*r7))>>>13,d7+=h0*r7,d7+=h1*r6,d7+=h2*r5,d7+=h3*r4,c=(d7+=h4*r3)>>>13,d7&=8191,d7+=h5*r2,d7+=h6*r1,d7+=h7*r0,d7+=h8*(5*r9),d8=c+=(d7+=h9*(5*r8))>>>13,d8+=h0*r8,d8+=h1*r7,d8+=h2*r6,d8+=h3*r5,c=(d8+=h4*r4)>>>13,d8&=8191,d8+=h5*r3,d8+=h6*r2,d8+=h7*r1,d8+=h8*r0,d9=c+=(d8+=h9*(5*r9))>>>13,d9+=h0*r9,d9+=h1*r8,d9+=h2*r7,d9+=h3*r6,c=(d9+=h4*r5)>>>13,d9&=8191,d9+=h5*r4,d9+=h6*r3,d9+=h7*r2,d9+=h8*r1,h0=d0=8191&(c=(c=((c+=(d9+=h9*r0)>>>13)<<2)+c|0)+(d0&=8191)|0),h1=d1+=c>>>=13,h2=d2&=8191,h3=d3&=8191,h4=d4&=8191,h5=d5&=8191,h6=d6&=8191,h7=d7&=8191,h8=d8&=8191,h9=d9&=8191,mpos+=16,bytes-=16;h[0]=h0,h[1]=h1,h[2]=h2,h[3]=h3,h[4]=h4,h[5]=h5,h[6]=h6,h[7]=h7,h[8]=h8,h[9]=h9}function secretbox(msg,nonce,key){checkArrayTypes(msg,nonce,key),checkLengths(key,nonce);for(var m=ByteArray(32+msg.length),c=ByteArray(m.length),i=0;i<msg.length;i++)m[i+32]=msg[i];return function(c,m,d,n,k){if(d<32)return-1;_stream_xor(c,0,m,0,d,n,k),_onetimeauth(c,16,c,32,d-32,c);for(var i=0;i<16;i++)c[i]=0}(c,m,m.length,nonce,key),c.subarray(16)}function secretbox_open(box,nonce,key){checkArrayTypes(box,nonce,key),checkLengths(key,nonce);for(var c=ByteArray(16+box.length),m=ByteArray(c.length),i=0;i<box.length;i++)c[i+16]=box[i];if(!(c.length<32||0!==function(m,c,d,n,k){var x=ByteArray(32);if(d<32)return-1;if(_stream(x,0,32,n,k),0!==function(h,hpos,m,mpos,n,k){var x=ByteArray(16);return _onetimeauth(x,0,m,mpos,n,k),_verify_16(h,hpos,x,0)}(c,16,c,32,d-32,x))return-1;_stream_xor(m,0,c,0,d,n,k);for(var i=0;i<32;i++)m[i]=0;return 0}(m,c,c.length,nonce,key)))return m.subarray(32)}function _onetimeauth(out,outpos,m,mpos,n,k){var key,t0,t1,t2,t3,t4,t5,t6,t7,r,pad,s=(key=k,r=HalfArray(10),pad=HalfArray(8),t0=255&key[0]|(255&key[1])<<8,r[0]=8191&t0,t1=255&key[2]|(255&key[3])<<8,r[1]=8191&(t0>>>13|t1<<3),t2=255&key[4]|(255&key[5])<<8,r[2]=7939&(t1>>>10|t2<<6),t3=255&key[6]|(255&key[7])<<8,r[3]=8191&(t2>>>7|t3<<9),t4=255&key[8]|(255&key[9])<<8,r[4]=255&(t3>>>4|t4<<12),r[5]=t4>>>1&8190,t5=255&key[10]|(255&key[11])<<8,r[6]=8191&(t4>>>14|t5<<2),t6=255&key[12]|(255&key[13])<<8,r[7]=8065&(t5>>>11|t6<<5),t7=255&key[14]|(255&key[15])<<8,r[8]=8191&(t6>>>8|t7<<8),r[9]=t7>>>5&127,pad[0]=255&key[16]|(255&key[17])<<8,pad[1]=255&key[18]|(255&key[19])<<8,pad[2]=255&key[20]|(255&key[21])<<8,pad[3]=255&key[22]|(255&key[23])<<8,pad[4]=255&key[24]|(255&key[25])<<8,pad[5]=255&key[26]|(255&key[27])<<8,pad[6]=255&key[28]|(255&key[29])<<8,pad[7]=255&key[30]|(255&key[31])<<8,{buffer:ByteArray(16),r:r,h:HalfArray(10),pad:pad,leftover:0,fin:0});return function(self,m,mpos,bytes){var i,want,buffer=self.buffer;if(self.leftover){for((want=16-self.leftover)>bytes&&(want=bytes),i=0;i<want;i++)buffer[self.leftover+i]=m[mpos+i];if(bytes-=want,mpos+=want,self.leftover+=want,self.leftover<16)return;poly1305_blocks(self,buffer,0,16),self.leftover=0}if(bytes>=16&&(poly1305_blocks(self,m,mpos,want=bytes-bytes%16),mpos+=want,bytes-=want),bytes){for(i=0;i<bytes;i++)buffer[self.leftover+i]=m[mpos+i];self.leftover+=bytes}}(s,m,mpos,n),function(self,mac,macpos){var c,mask,f,i,g=HalfArray(10),buffer=self.buffer,h=self.h,pad=self.pad,leftover=self.leftover;if(leftover){for(i=leftover,buffer[i++]=1;i<16;i++)buffer[i]=0;self.fin=1,poly1305_blocks(self,buffer,0,16)}for(c=h[1]>>>13,h[1]&=8191,i=2;i<10;i++)h[i]+=c,c=h[i]>>>13,h[i]&=8191;for(h[0]+=5*c,c=h[0]>>>13,h[0]&=8191,h[1]+=c,c=h[1]>>>13,h[1]&=8191,h[2]+=c,g[0]=h[0]+5,c=g[0]>>>13,g[0]&=8191,i=1;i<10;i++)g[i]=h[i]+c,c=g[i]>>>13,g[i]&=8191;for(g[9]-=8192,mask=(1^c)-1,i=0;i<10;i++)g[i]&=mask;for(mask=~mask,i=0;i<10;i++)h[i]=h[i]&mask|g[i];for(h[0]=65535&(h[0]|h[1]<<13),h[1]=65535&(h[1]>>>3|h[2]<<10),h[2]=65535&(h[2]>>>6|h[3]<<7),h[3]=65535&(h[3]>>>9|h[4]<<4),h[4]=65535&(h[4]>>>12|h[5]<<1|h[6]<<14),h[5]=65535&(h[6]>>>2|h[7]<<11),h[6]=65535&(h[7]>>>5|h[8]<<8),h[7]=65535&(h[8]>>>8|h[9]<<5),f=h[0]+pad[0],h[0]=65535&f,i=1;i<8;i++)f=(h[i]+pad[i]|0)+(f>>>16)|0,h[i]=65535&f;mac[macpos+0]=h[0]>>>0&255,mac[macpos+1]=h[0]>>>8&255,mac[macpos+2]=h[1]>>>0&255,mac[macpos+3]=h[1]>>>8&255,mac[macpos+4]=h[2]>>>0&255,mac[macpos+5]=h[2]>>>8&255,mac[macpos+6]=h[3]>>>0&255,mac[macpos+7]=h[3]>>>8&255,mac[macpos+8]=h[4]>>>0&255,mac[macpos+9]=h[4]>>>8&255,mac[macpos+10]=h[5]>>>0&255,mac[macpos+11]=h[5]>>>8&255,mac[macpos+12]=h[6]>>>0&255,mac[macpos+13]=h[6]>>>8&255,mac[macpos+14]=h[7]>>>0&255,mac[macpos+15]=h[7]>>>8&255}(s,out,outpos),0}function box_box(msg,nonce,publicKey,secretKey){return secretbox(msg,nonce,box_before(publicKey,secretKey))}function box_before(publicKey,secretKey){checkArrayTypes(publicKey,secretKey),function(pk,sk){if(32!=pk.length)throw new Error("bad public key size");if(32!=sk.length)throw new Error("bad secret key size")}(publicKey,secretKey);var k=ByteArray(32);return function(k,y,x){var s=ByteArray(32);_scalarMult(s,x,y),_hsalsa20(k,_0,s,_sigma)}(k,publicKey,secretKey),k}var box_after=secretbox;function box_open(msg,nonce,publicKey,secretKey){return secretbox_open(msg,nonce,box_before(publicKey,secretKey))}var box_open_after=secretbox_open;function box_keyPair(){var y,x,pk=ByteArray(32),sk=ByteArray(32);return y=pk,_randomBytes(x=sk,32),_scalarMult_base(y,x),{publicKey:pk,secretKey:sk}}function box_keyPair_fromSecretKey(secretKey){if(checkArrayTypes(secretKey),32!==secretKey.length)throw new Error("bad secret key size");var pk=ByteArray(32);return _scalarMult_base(pk,secretKey),{publicKey:pk,secretKey:ByteArray(secretKey)}}function hash(msg){checkArrayTypes(msg);var h=ByteArray(64);return _hash(h,msg,msg.length),h}function _hash(out,m,n){var i,hh=IntArray(8),hl=IntArray(8),x=ByteArray(256),b=n;for(hh[0]=1779033703,hh[1]=3144134277,hh[2]=1013904242,hh[3]=2773480762,hh[4]=1359893119,hh[5]=2600822924,hh[6]=528734635,hh[7]=1541459225,hl[0]=4089235720,hl[1]=2227873595,hl[2]=4271175723,hl[3]=1595750129,hl[4]=2917565137,hl[5]=725511199,hl[6]=4215389547,hl[7]=327033209,_hashblocks_hl(hh,hl,m,n),n%=128,i=0;i<n;i++)x[i]=m[b-n+i];for(x[n]=128,x[(n=256-128*(n<112?1:0))-9]=0,_ts64(x,n-8,b/536870912|0,b<<3),_hashblocks_hl(hh,hl,x,n),i=0;i<8;i++)_ts64(out,8*i,hh[i],hl[i]);return 0}var _K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function _hashblocks_hl(hh,hl,m,n){for(var bh0,bh1,bh2,bh3,bh4,bh5,bh6,bh7,bl0,bl1,bl2,bl3,bl4,bl5,bl6,bl7,th,tl,i,j,h,l,a,b,c,d,wh=IntArray(16),wl=IntArray(16),ah0=hh[0],ah1=hh[1],ah2=hh[2],ah3=hh[3],ah4=hh[4],ah5=hh[5],ah6=hh[6],ah7=hh[7],al0=hl[0],al1=hl[1],al2=hl[2],al3=hl[3],al4=hl[4],al5=hl[5],al6=hl[6],al7=hl[7],pos=0;n>=128;){for(i=0;i<16;i++)j=8*i+pos,wh[i]=m[j+0]<<24|m[j+1]<<16|m[j+2]<<8|m[j+3],wl[i]=m[j+4]<<24|m[j+5]<<16|m[j+6]<<8|m[j+7];for(i=0;i<80;i++)if(bh0=ah0,bh1=ah1,bh2=ah2,bh3=ah3,bh4=ah4,bh5=ah5,bh6=ah6,bh7=ah7,bl0=al0,bl1=al1,bl2=al2,bl3=al3,bl4=al4,bl5=al5,bl6=al6,bl7=al7,a=65535&(l=al7),b=l>>>16,c=65535&(h=ah7),d=h>>>16,a+=65535&(l=(al4>>>14|ah4<<18)^(al4>>>18|ah4<<14)^(ah4>>>9|al4<<23)),b+=l>>>16,c+=65535&(h=(ah4>>>14|al4<<18)^(ah4>>>18|al4<<14)^(al4>>>9|ah4<<23)),d+=h>>>16,a+=65535&(l=al4&al5^~al4&al6),b+=l>>>16,c+=65535&(h=ah4&ah5^~ah4&ah6),d+=h>>>16,h=_K[2*i],a+=65535&(l=_K[2*i+1]),b+=l>>>16,c+=65535&h,d+=h>>>16,h=wh[i%16],b+=(l=wl[i%16])>>>16,c+=65535&h,d+=h>>>16,c+=(b+=(a+=65535&l)>>>16)>>>16,a=65535&(l=tl=65535&a|b<<16),b=l>>>16,c=65535&(h=th=65535&c|(d+=c>>>16)<<16),d=h>>>16,a+=65535&(l=(al0>>>28|ah0<<4)^(ah0>>>2|al0<<30)^(ah0>>>7|al0<<25)),b+=l>>>16,c+=65535&(h=(ah0>>>28|al0<<4)^(al0>>>2|ah0<<30)^(al0>>>7|ah0<<25)),d+=h>>>16,b+=(l=al0&al1^al0&al2^al1&al2)>>>16,c+=65535&(h=ah0&ah1^ah0&ah2^ah1&ah2),d+=h>>>16,bh7=65535&(c+=(b+=(a+=65535&l)>>>16)>>>16)|(d+=c>>>16)<<16,bl7=65535&a|b<<16,a=65535&(l=bl3),b=l>>>16,c=65535&(h=bh3),d=h>>>16,b+=(l=tl)>>>16,c+=65535&(h=th),d+=h>>>16,ah1=bh0,ah2=bh1,ah3=bh2,ah4=bh3=65535&(c+=(b+=(a+=65535&l)>>>16)>>>16)|(d+=c>>>16)<<16,ah5=bh4,ah6=bh5,ah7=bh6,ah0=bh7,al1=bl0,al2=bl1,al3=bl2,al4=bl3=65535&a|b<<16,al5=bl4,al6=bl5,al7=bl6,al0=bl7,i%16==15)for(j=0;j<16;j++)h=wh[j],a=65535&(l=wl[j]),b=l>>>16,c=65535&h,d=h>>>16,h=wh[(j+9)%16],a+=65535&(l=wl[(j+9)%16]),b+=l>>>16,c+=65535&h,d+=h>>>16,th=wh[(j+1)%16],a+=65535&(l=((tl=wl[(j+1)%16])>>>1|th<<31)^(tl>>>8|th<<24)^(tl>>>7|th<<25)),b+=l>>>16,c+=65535&(h=(th>>>1|tl<<31)^(th>>>8|tl<<24)^th>>>7),d+=h>>>16,th=wh[(j+14)%16],b+=(l=((tl=wl[(j+14)%16])>>>19|th<<13)^(th>>>29|tl<<3)^(tl>>>6|th<<26))>>>16,c+=65535&(h=(th>>>19|tl<<13)^(tl>>>29|th<<3)^th>>>6),d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,wh[j]=65535&c|d<<16,wl[j]=65535&a|b<<16;a=65535&(l=al0),b=l>>>16,c=65535&(h=ah0),d=h>>>16,h=hh[0],b+=(l=hl[0])>>>16,c+=65535&h,d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,hh[0]=ah0=65535&c|d<<16,hl[0]=al0=65535&a|b<<16,a=65535&(l=al1),b=l>>>16,c=65535&(h=ah1),d=h>>>16,h=hh[1],b+=(l=hl[1])>>>16,c+=65535&h,d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,hh[1]=ah1=65535&c|d<<16,hl[1]=al1=65535&a|b<<16,a=65535&(l=al2),b=l>>>16,c=65535&(h=ah2),d=h>>>16,h=hh[2],b+=(l=hl[2])>>>16,c+=65535&h,d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,hh[2]=ah2=65535&c|d<<16,hl[2]=al2=65535&a|b<<16,a=65535&(l=al3),b=l>>>16,c=65535&(h=ah3),d=h>>>16,h=hh[3],b+=(l=hl[3])>>>16,c+=65535&h,d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,hh[3]=ah3=65535&c|d<<16,hl[3]=al3=65535&a|b<<16,a=65535&(l=al4),b=l>>>16,c=65535&(h=ah4),d=h>>>16,h=hh[4],b+=(l=hl[4])>>>16,c+=65535&h,d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,hh[4]=ah4=65535&c|d<<16,hl[4]=al4=65535&a|b<<16,a=65535&(l=al5),b=l>>>16,c=65535&(h=ah5),d=h>>>16,h=hh[5],b+=(l=hl[5])>>>16,c+=65535&h,d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,hh[5]=ah5=65535&c|d<<16,hl[5]=al5=65535&a|b<<16,a=65535&(l=al6),b=l>>>16,c=65535&(h=ah6),d=h>>>16,h=hh[6],b+=(l=hl[6])>>>16,c+=65535&h,d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,hh[6]=ah6=65535&c|d<<16,hl[6]=al6=65535&a|b<<16,a=65535&(l=al7),b=l>>>16,c=65535&(h=ah7),d=h>>>16,h=hh[7],b+=(l=hl[7])>>>16,c+=65535&h,d+=h>>>16,d+=(c+=(b+=(a+=65535&l)>>>16)>>>16)>>>16,hh[7]=ah7=65535&c|d<<16,hl[7]=al7=65535&a|b<<16,pos+=128,n-=128}return n}function _ts64(x,i,h,l){x[i]=h>>24&255,x[i+1]=h>>16&255,x[i+2]=h>>8&255,x[i+3]=255&h,x[i+4]=l>>24&255,x[i+5]=l>>16&255,x[i+6]=l>>8&255,x[i+7]=255&l}function sign(msg,secretKey){if(checkArrayTypes(msg,secretKey),64!==secretKey.length)throw new Error("bad secret key size");var signedMsg=ByteArray(64+msg.length);return function(sm,m,n,sk){var i,j,d=ByteArray(64),h=ByteArray(64),r=ByteArray(64),x=NumArray(64),p=[gf(),gf(),gf(),gf()];_hash(d,sk,32),d[0]&=248,d[31]&=127,d[31]|=64;var smlen=n+64;for(i=0;i<n;i++)sm[64+i]=m[i];for(i=0;i<32;i++)sm[32+i]=d[32+i];for(_hash(r,sm.subarray(32),n+32),reduce(r),scalarbase(p,r),pack(sm,p),i=32;i<64;i++)sm[i]=sk[i];for(_hash(h,sm,n+64),reduce(h),i=0;i<64;i++)x[i]=0;for(i=0;i<32;i++)x[i]=r[i];for(i=0;i<32;i++)for(j=0;j<32;j++)x[i+j]+=h[i]*d[j];modL(sm.subarray(32),x)}(signedMsg,msg,msg.length,secretKey),signedMsg}function sign_open(signedMsg,publicKey){if(checkArrayTypes(signedMsg,publicKey),32!==publicKey.length)throw new Error("bad public key size");var tmp=ByteArray(signedMsg.length),mlen=_sign_open(tmp,signedMsg,signedMsg.length,publicKey);if(!(mlen<0)){for(var m=ByteArray(mlen),i=0;i<m.length;i++)m[i]=tmp[i];return m}}function sign_detached(msg,secretKey){for(var signedMsg=sign(msg,secretKey),sig=ByteArray(64),i=0;i<sig.length;i++)sig[i]=signedMsg[i];return sig}function sign_detached_verify(msg,sig,publicKey){if(checkArrayTypes(msg,sig,publicKey),64!==sig.length)throw new Error("bad signature size");if(32!==publicKey.length)throw new Error("bad public key size");var i,sm=ByteArray(64+msg.length),m=ByteArray(64+msg.length);for(i=0;i<64;i++)sm[i]=sig[i];for(i=0;i<msg.length;i++)sm[i+64]=msg[i];return _sign_open(m,sm,sm.length,publicKey)>=0}function sign_keyPair(){var pk=ByteArray(32),sk=ByteArray(64);return _sign_keypair(pk,sk,!1),{publicKey:pk,secretKey:sk}}function sign_keyPair_fromSecretKey(secretKey){if(checkArrayTypes(secretKey),64!==secretKey.length)throw new Error("bad secret key size");for(var pk=ByteArray(32),i=0;i<pk.length;i++)pk[i]=secretKey[32+i];return{publicKey:pk,secretKey:ByteArray(secretKey)}}function sign_keyPair_fromSeed(seed){if(checkArrayTypes(seed),32!==seed.length)throw new Error("bad seed size");for(var pk=ByteArray(32),sk=ByteArray(64),i=0;i<32;i++)sk[i]=seed[i];return _sign_keypair(pk,sk,!0),{publicKey:pk,secretKey:sk}}function _sign_keypair(pk,sk,seeded){var i,d=ByteArray(64),p=[gf(),gf(),gf(),gf()];for(seeded||_randomBytes(sk,32),_hash(d,sk,32),d[0]&=248,d[31]&=127,d[31]|=64,scalarbase(p,d),pack(pk,p),i=0;i<32;i++)sk[i+32]=pk[i];return 0}function _sign_open(m,sm,n,pk){var i,t=ByteArray(32),h=ByteArray(64),p=[gf(),gf(),gf(),gf()],q=[gf(),gf(),gf(),gf()];if(-1,n<64||function(r,p){var t=gf(),chk=gf(),num=gf(),den=gf(),den2=gf(),den4=gf(),den6=gf();set25519(r[2],gf1),unpack25519(r[1],p),S(num,r[1]),M(den,num,D),Z(num,num,r[2]),A(den,r[2],den),S(den2,den),S(den4,den2),M(den6,den4,den2),M(t,den6,num),M(t,t,den),function(o,i){var a,c=gf();for(a=0;a<16;a++)c[a]=i[a];for(a=250;a>=0;a--)S(c,c),1!==a&&M(c,c,i);for(a=0;a<16;a++)o[a]=c[a]}(t,t),M(t,t,num),M(t,t,den),M(t,t,den),M(r[0],t,den),S(chk,r[0]),M(chk,chk,den),neq25519(chk,num)&&M(r[0],r[0],I);if(S(chk,r[0]),M(chk,chk,den),neq25519(chk,num))return-1;par25519(r[0])===p[31]>>7&&Z(r[0],gf0,r[0]);return M(r[3],r[0],r[1]),0}(q,pk))return-1;for(i=0;i<n;i++)m[i]=sm[i];for(i=0;i<32;i++)m[i+32]=pk[i];if(_hash(h,m,n),reduce(h),scalarmult(p,q,h),scalarbase(q,sm.subarray(32)),add(p,q),pack(t,p),n-=64,_verify_32(sm,0,t,0)){for(i=0;i<n;i++)m[i]=0;return-1}for(i=0;i<n;i++)m[i]=sm[i+64];return n}function scalarbase(p,s){var q=[gf(),gf(),gf(),gf()];set25519(q[0],X),set25519(q[1],Y),set25519(q[2],gf1),M(q[3],X,Y),scalarmult(p,q,s)}function scalarmult(p,q,s){var b,i;for(set25519(p[0],gf0),set25519(p[1],gf1),set25519(p[2],gf1),set25519(p[3],gf0),i=255;i>=0;--i)cswap(p,q,b=s[i/8|0]>>(7&i)&1),add(q,p),add(p,p),cswap(p,q,b)}function pack(r,p){var tx=gf(),ty=gf(),zi=gf();inv25519(zi,p[2]),M(tx,p[0],zi),M(ty,p[1],zi),pack25519(r,ty),r[31]^=par25519(tx)<<7}function reduce(r){var i,x=NumArray(64);for(i=0;i<64;i++)x[i]=r[i];for(i=0;i<64;i++)r[i]=0;modL(r,x)}var L=NumArray([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(r,x){var carry,i,j,k;for(i=63;i>=32;--i){for(carry=0,j=i-32,k=i-12;j<k;++j)x[j]+=carry-16*x[i]*L[j-(i-32)],carry=x[j]+128>>8,x[j]-=256*carry;x[j]+=carry,x[i]=0}for(carry=0,j=0;j<32;j++)x[j]+=carry-(x[31]>>4)*L[j],carry=x[j]>>8,x[j]&=255;for(j=0;j<32;j++)x[j]-=carry*L[j];for(i=0;i<32;i++)x[i+1]+=x[i]>>8,r[i]=255&x[i]}function add(p,q){var a=gf(),b=gf(),c=gf(),d=gf(),e=gf(),f=gf(),g=gf(),h=gf(),t=gf();Z(a,p[1],p[0]),Z(t,q[1],q[0]),M(a,a,t),A(b,p[0],p[1]),A(t,q[0],q[1]),M(b,b,t),M(c,p[3],q[3]),M(c,c,D2),M(d,p[2],q[2]),A(d,d,d),Z(e,b,a),Z(f,d,c),A(g,d,c),A(h,b,a),M(p[0],e,f),M(p[1],h,g),M(p[2],g,f),M(p[3],e,h)}function cswap(p,q,b){for(var i=0;i<4;i++)sel25519(p[i],q[i],b)}function auth(msg,key){var out=ByteArray(32);return out.set(hmac(msg,key).subarray(0,32)),out}var BLOCK_SIZE=128,HASH_SIZE=64;function hmac(msg,key){var i,innerHash,buf=ByteArray(BLOCK_SIZE+Math.max(HASH_SIZE,msg.length));for(key.length>BLOCK_SIZE&&(key=hash(key)),i=0;i<BLOCK_SIZE;i++)buf[i]=54;for(i=0;i<key.length;i++)buf[i]^=key[i];for(buf.set(msg,BLOCK_SIZE),innerHash=hash(buf.subarray(0,BLOCK_SIZE+msg.length)),i=0;i<BLOCK_SIZE;i++)buf[i]=92;for(i=0;i<key.length;i++)buf[i]^=key[i];return buf.set(innerHash,BLOCK_SIZE),hash(buf.subarray(0,BLOCK_SIZE+innerHash.length))}var auth_full=hmac;function blake2s(input,key,outlen){void 0===outlen&&(outlen=32);var ctx=blake2s_init(outlen,key);return blake2s_update(ctx,input),blake2s_final(ctx)}function blake2s_init(outlen,key){if(!(outlen>0&&outlen<=32))throw new Error("Incorrect output length, should be in [1, 32]");var keylen=key?key.length:0;if(key&&!(keylen>0&&keylen<=32))throw new Error("Incorrect key length, should be in [1, 32]");var ctx={h:WordArray(BLAKE2S_IV),b:WordArray(64),c:0,t:0,outlen:outlen};return ctx.h[0]^=16842752^keylen<<8^outlen,keylen&&(blake2s_update(ctx,key),ctx.c=64),ctx}function blake2s_update(ctx,input){for(var i=0;i<input.length;i++)64===ctx.c&&(ctx.t+=ctx.c,blake2s_compress(ctx,!1),ctx.c=0),ctx.b[ctx.c++]=input[i]}function blake2s_final(ctx){for(ctx.t+=ctx.c;ctx.c<64;)ctx.b[ctx.c++]=0;blake2s_compress(ctx,!0);for(var out=ByteArray(ctx.outlen),i=0;i<ctx.outlen;i++)out[i]=ctx.h[i>>2]>>8*(3&i)&255;return out}var BLAKE2S_IV=WordArray([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SIGMA=ByteArray([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),v=WordArray(16),blake2s_m=WordArray(16);function blake2s_compress(ctx,last){var i=0;for(i=0;i<8;i++)v[i]=ctx.h[i],v[i+8]=BLAKE2S_IV[i];for(v[12]^=ctx.t,v[13]^=ctx.t/4294967296,last&&(v[14]=~v[14]),i=0;i<16;i++)blake2s_m[i]=B2S_GET32(ctx.b,4*i);for(i=0;i<10;i++)B2S_G(0,4,8,12,blake2s_m[SIGMA[16*i+0]],blake2s_m[SIGMA[16*i+1]]),B2S_G(1,5,9,13,blake2s_m[SIGMA[16*i+2]],blake2s_m[SIGMA[16*i+3]]),B2S_G(2,6,10,14,blake2s_m[SIGMA[16*i+4]],blake2s_m[SIGMA[16*i+5]]),B2S_G(3,7,11,15,blake2s_m[SIGMA[16*i+6]],blake2s_m[SIGMA[16*i+7]]),B2S_G(0,5,10,15,blake2s_m[SIGMA[16*i+8]],blake2s_m[SIGMA[16*i+9]]),B2S_G(1,6,11,12,blake2s_m[SIGMA[16*i+10]],blake2s_m[SIGMA[16*i+11]]),B2S_G(2,7,8,13,blake2s_m[SIGMA[16*i+12]],blake2s_m[SIGMA[16*i+13]]),B2S_G(3,4,9,14,blake2s_m[SIGMA[16*i+14]],blake2s_m[SIGMA[16*i+15]]);for(i=0;i<8;i++)ctx.h[i]^=v[i]^v[i+8]}function B2S_GET32(v,i){return v[i]^v[i+1]<<8^v[i+2]<<16^v[i+3]<<24}function B2S_G(a,b,c,d,x,y){v[a]=v[a]+v[b]+x,v[d]=ROTR32(v[d]^v[a],16),v[c]=v[c]+v[d],v[b]=ROTR32(v[b]^v[c],12),v[a]=v[a]+v[b]+y,v[d]=ROTR32(v[d]^v[a],8),v[c]=v[c]+v[d],v[b]=ROTR32(v[b]^v[c],7)}function ROTR32(x,y){return x>>>y^x<<32-y}function blake2b(input,key,outlen){void 0===outlen&&(outlen=64);var ctx=blake2b_init(outlen,key);return blake2b_update(ctx,input),blake2b_final(ctx)}function blake2b_init(outlen,key){if(0===outlen||outlen>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(key&&key.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");for(var h=WordArray(16),i=0;i<16;i++)h[i]=BLAKE2B_IV32[i];var keylen=key?key.length:0;h[0]^=16842752^keylen<<8^outlen;var ctx={b:ByteArray(128),h:h,t:0,c:0,outlen:outlen};return key&&(blake2b_update(ctx,key),ctx.c=128),ctx}function blake2b_update(ctx,input){for(var i=0;i<input.length;i++)128===ctx.c&&(ctx.t+=ctx.c,blake2b_compress(ctx,!1),ctx.c=0),ctx.b[ctx.c++]=input[i]}function blake2b_final(ctx){for(ctx.t+=ctx.c;ctx.c<128;)ctx.b[ctx.c++]=0;blake2b_compress(ctx,!0);for(var out=ByteArray(ctx.outlen),i=0;i<ctx.outlen;i++)out[i]=ctx.h[i>>2]>>8*(3&i);return out}var BLAKE2B_IV32=WordArray([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),SIGMA82=ByteArray([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(x){return 2*x})),blake2b_v=WordArray(32),blake2b_m=WordArray(32);function blake2b_compress(ctx,last){var i;for(i=0;i<16;i++)blake2b_v[i]=ctx.h[i],blake2b_v[i+16]=BLAKE2B_IV32[i];for(blake2b_v[24]=blake2b_v[24]^ctx.t,blake2b_v[25]=blake2b_v[25]^ctx.t/4294967296,last&&(blake2b_v[28]=~blake2b_v[28],blake2b_v[29]=~blake2b_v[29]),i=0;i<32;i++)blake2b_m[i]=B2B_GET32(ctx.b,4*i);for(i=0;i<12;i++)B2B_G(0,8,16,24,SIGMA82[16*i+0],SIGMA82[16*i+1]),B2B_G(2,10,18,26,SIGMA82[16*i+2],SIGMA82[16*i+3]),B2B_G(4,12,20,28,SIGMA82[16*i+4],SIGMA82[16*i+5]),B2B_G(6,14,22,30,SIGMA82[16*i+6],SIGMA82[16*i+7]),B2B_G(0,10,20,30,SIGMA82[16*i+8],SIGMA82[16*i+9]),B2B_G(2,12,22,24,SIGMA82[16*i+10],SIGMA82[16*i+11]),B2B_G(4,14,16,26,SIGMA82[16*i+12],SIGMA82[16*i+13]),B2B_G(6,8,18,28,SIGMA82[16*i+14],SIGMA82[16*i+15]);for(i=0;i<16;i++)ctx.h[i]=ctx.h[i]^blake2b_v[i]^blake2b_v[i+16]}function ADD64AA(v,a,b){var o0=v[a]+v[b],o1=v[a+1]+v[b+1];o0>=4294967296&&o1++,v[a]=o0,v[a+1]=o1}function ADD64AC(v,a,b0,b1){var o0=v[a]+b0;b0<0&&(o0+=4294967296);var o1=v[a+1]+b1;o0>=4294967296&&o1++,v[a]=o0,v[a+1]=o1}function B2B_GET32(arr,i){return arr[i]^arr[i+1]<<8^arr[i+2]<<16^arr[i+3]<<24}function B2B_G(a,b,c,d,ix,iy){var x0=blake2b_m[ix],x1=blake2b_m[ix+1],y0=blake2b_m[iy],y1=blake2b_m[iy+1];ADD64AA(blake2b_v,a,b),ADD64AC(blake2b_v,a,x0,x1);var xor0=blake2b_v[d]^blake2b_v[a],xor1=blake2b_v[d+1]^blake2b_v[a+1];blake2b_v[d]=xor1,blake2b_v[d+1]=xor0,ADD64AA(blake2b_v,c,d),xor0=blake2b_v[b]^blake2b_v[c],xor1=blake2b_v[b+1]^blake2b_v[c+1],blake2b_v[b]=xor0>>>24^xor1<<8,blake2b_v[b+1]=xor1>>>24^xor0<<8,ADD64AA(blake2b_v,a,b),ADD64AC(blake2b_v,a,y0,y1),xor0=blake2b_v[d]^blake2b_v[a],xor1=blake2b_v[d+1]^blake2b_v[a+1],blake2b_v[d]=xor0>>>16^xor1<<16,blake2b_v[d+1]=xor1>>>16^xor0<<16,ADD64AA(blake2b_v,c,d),xor0=blake2b_v[b]^blake2b_v[c],xor1=blake2b_v[b+1]^blake2b_v[c+1],blake2b_v[b]=xor1>>>31^xor0<<1,blake2b_v[b+1]=xor0>>>31^xor1<<1}function sealedbox(m,pk){var c=ByteArray(48+m.length),ek=box_keyPair();c.set(ek.publicKey);var boxed=box_box(m,nonce_gen(ek.publicKey,pk),pk,ek.secretKey);c.set(boxed,ek.publicKey.length);for(var i=0;i<ek.secretKey.length;i++)ek.secretKey[i]=0;return c}function sealedbox_open(c,pk,sk){if(!(c.length<48)){var epk=c.subarray(0,32),nonce=nonce_gen(epk,pk);return box_open(c.subarray(32),nonce,epk,sk)}}function nonce_gen(pk1,pk2){var state=blake2b_init(24);return blake2b_update(state,pk1),blake2b_update(state,pk2),blake2b_final(state)}}]);